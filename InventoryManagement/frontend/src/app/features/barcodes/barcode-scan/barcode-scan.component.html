<div class="space-y-4">
  <h1 class="page-title">Scan Barcode</h1>

  <div class="card p-4 space-y-4">
    <div>
      <label class="label">Scan or Enter Barcode (Code 128 or QR Code)</label>
      <div class="flex gap-2">
        <input
          type="text"
          class="input flex-1"
          [(ngModel)]="scannedBarcode"
          (input)="onBarcodeInput($any($event.target).value)"
          placeholder="Scan barcode or enter manually"
          autofocus
        />
        <button *ngIf="scannedBarcode" class="btn btn-secondary" (click)="clearScan()" type="button">
          <lucide-icon name="x" class="h-4 w-4"></lucide-icon>
        </button>
      </div>
      <p class="text-sm text-gray-500 mt-1">Supported formats: Code 128, QR Code</p>
    </div>

    <div *ngIf="loading" class="flex items-center justify-center py-8">
      <app-spinner class="h-8 w-8"></app-spinner>
      <span class="ml-2 text-gray-600">Searching for product...</span>
    </div>

    <div *ngIf="product && !loading" class="space-y-4">
      <div class="border-t pt-4">
        <h2 class="text-lg font-semibold mb-4">Product Details</h2>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <div>
            <label class="text-sm font-medium text-gray-700">Name</label>
            <p class="text-gray-900 font-semibold">{{ product.name }}</p>
          </div>
          <div>
            <label class="text-sm font-medium text-gray-700">SKU</label>
            <p class="text-gray-900">{{ product.sku || '-' }}</p>
          </div>
          <div>
            <label class="text-sm font-medium text-gray-700">Barcode</label>
            <p class="text-gray-900">{{ product.barcode || scannedBarcode }}</p>
          </div>
          <div>
            <label class="text-sm font-medium text-gray-700">Category</label>
            <p class="text-gray-900">{{ product.category?.name || '-' }}</p>
          </div>
          <div>
            <label class="text-sm font-medium text-gray-700">Brand</label>
            <p class="text-gray-900">{{ product.brand?.name || '-' }}</p>
          </div>
          <div>
            <label class="text-sm font-medium text-gray-700">Variant</label>
            <p class="text-gray-900">{{ product.variant?.name || '-' }}</p>
          </div>
          <div>
            <label class="text-sm font-medium text-gray-700">Price</label>
            <p class="text-gray-900">${{ product.price || '0.00' }}</p>
          </div>
          <div>
            <label class="text-sm font-medium text-gray-700">Cost</label>
            <p class="text-gray-900">${{ product.cost || '0.00' }}</p>
          </div>
          <div>
            <label class="text-sm font-medium text-gray-700">Stock</label>
            <p class="text-gray-900">{{ product.quantity || 0 }} units</p>
          </div>
          <div *ngIf="product.description">
            <label class="text-sm font-medium text-gray-700">Description</label>
            <p class="text-gray-900">{{ product.description }}</p>
          </div>
        </div>
      </div>
      <div class="flex gap-2 pt-4 border-t" *ngIf="product && !isRedirecting">
        <button class="btn btn-primary" (click)="viewProductDetails()">
          View Full Details
        </button>
        <button *ngIf="product.pdfUrl" class="btn btn-secondary" (click)="openPdf()">
          Open PDF
        </button>
      </div>
      <div *ngIf="isRedirecting" class="text-center py-4">
        <app-spinner class="h-6 w-6 mx-auto"></app-spinner>
        <p class="text-sm text-gray-600 mt-2">Redirecting to PDF...</p>
      </div>
    </div>

    <div *ngIf="!product && !loading && scannedBarcode" class="text-center py-8 text-gray-500">
      <p>No product found for barcode: <strong>{{ scannedBarcode }}</strong></p>
      <p class="text-sm mt-2">Make sure the barcode is correct and the product exists in the system.</p>
    </div>
  </div>
</div>

